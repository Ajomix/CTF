<p><span style="font-family: verdana;">&nbsp;- Đề bài cho chúng ta 1 file elf check flag , Khi mở lên chúng ta có thể thấy 3 lệnh lạ :<b> pshufb,paddd,pxor </b>và được sử dụng cùng với thanh ghi 128 bit :</span></p><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFuJses1KhzOz46_mYo9bl8eSX8Pv_W36V0QHoTIQELu6IX01VDbM8Xpu1XBifpicuWGngOyL1sczoggfryZ-XsTq69XmWZqt6UPM-jxJyYUgAzqzvf4ku7z53FO44wkXABl9otnv052DzEt_nh3Gm7gXs8PNKwh663MlwH1eY2xKRhbc4TyC4VlwYGw/s883/image_2022-03-25_232455.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="583" data-original-width="883" height="324" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFuJses1KhzOz46_mYo9bl8eSX8Pv_W36V0QHoTIQELu6IX01VDbM8Xpu1XBifpicuWGngOyL1sczoggfryZ-XsTq69XmWZqt6UPM-jxJyYUgAzqzvf4ku7z53FO44wkXABl9otnv052DzEt_nh3Gm7gXs8PNKwh663MlwH1eY2xKRhbc4TyC4VlwYGw/w491-h324/image_2022-03-25_232455.png" width="491" /></a></div><br /><span style="font-family: verdana;"><b>[*]&nbsp;</b></span><b style="font-family: verdana;">pshufb&nbsp;</b><p></p><p><span style="font-family: verdana;">- Sau khi google một lúc thì em thấy rằng câu lệnh&nbsp;</span><b style="font-family: verdana;">pshufb </b><span style="font-family: verdana;">này sẽ trộn data input chúng ta nhập vào với data của tác giả đã cho sẵn ở <b>cs:SHUFFLE , </b>và cách để khải triển lệnh này trên python như sau :</span></p><p></p><div class="separator" style="clear: both; text-align: center;"><br /></div><span style="font-family: verdana;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdKe9XrgBbVDzEX2SqapF8tJFB2lIDTmnOcFg-cyvypayGtsbMGn6Z2t8r4_XxwnOD3jLmRhNFCLtBSXjuTMEYM-Pkznx-ybFXBkZe2lvYgKTNdUXsPF3PGSXv5AI8qAXee5QRQbBt2cLKz_nzv1kFtS-DRFPqLq1vHDet6r99D95dkVzF-7Ypqwvn2Q/s644/image_2022-03-25_232850.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="209" data-original-width="644" height="194" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdKe9XrgBbVDzEX2SqapF8tJFB2lIDTmnOcFg-cyvypayGtsbMGn6Z2t8r4_XxwnOD3jLmRhNFCLtBSXjuTMEYM-Pkznx-ybFXBkZe2lvYgKTNdUXsPF3PGSXv5AI8qAXee5QRQbBt2cLKz_nzv1kFtS-DRFPqLq1vHDet6r99D95dkVzF-7Ypqwvn2Q/w598-h194/image_2022-03-25_232850.png" width="598" /></a></div>- Ở đây mảng src sẽ là data&nbsp;</span><b style="font-family: verdana;">cs:SHUFFLE&nbsp; </b><span style="font-family: verdana;">của tác giả cho sẵn, newdest sẽ chứa data input của chúng ta sau khi sắp xếp&nbsp;</span><p></p><p><span style="font-family: verdana;"><b>[*]&nbsp;</b></span><b style="font-family: verdana;">paddd <span style="color: #e06666;">(</span></b><span style="color: #e06666; font-family: verdana;"><b>paddd&nbsp; &nbsp;xmm0, cs:ADD32)</b></span></p><p><span style="font-family: verdana;">- Lệnh này sẽ cộng từng 4 byte với 4 byte của<b> cs:ADD32 </b>và trả lại kết quả vào thanh ghi 128 bit xmm0.</span></p><p><span style="font-family: verdana;"><b>[*] pxor <span style="color: #cc0000;">(</span></b></span><b style="font-family: verdana;"><span style="color: #e06666;">pxor&nbsp;</span></b><b style="font-family: verdana;"><span style="color: #cc0000;">xmm0, cs:XOR)</span></b></p><p><span style="font-family: verdana;"><b>- </b>Lệnh này tương tự lệnh paddd nhưng nó sẽ sử dụng phép toán<b>&nbsp;XOR.</b></span></p><p><span style="font-family: verdana;"><b>[*] Thuật toán của chương trình :</b></span></p><p><span style="font-family: verdana;"><b>- </b>Chương trình sẽ lấy input của chúng ta nhập vào với 15 kí tự :</span></p><p><span style="font-family: verdana;">&nbsp;+ Sau đó sẽ trộn (<b><span style="color: red;">pshufb</span></b>) data của chúng ta với data của tác giả&nbsp;</span></p><p><span style="font-family: verdana;">&nbsp;+ Tiếp đến chương trình sẽ cộng data của chúng ta với data của tác giả (<b><span style="color: red;">paddd</span></b>)</span></p><p><span style="font-family: verdana;"><b>&nbsp;+</b> cuối cùng là chương trình <b>XOR </b>data&nbsp;</span></p><p><span style="font-family: verdana;">Và sẽ so sánh data sau khi đã encrypt có bằng chính nó lúc ban đầu hay không + Check prefix mong muốn là "<b>CTF{</b>" :&nbsp;</span></p><p><span style="font-family: verdana;"></span></p><div class="separator" style="clear: both; text-align: center;"><span style="font-family: verdana;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjfV8HV1ON0BjYWXD5oyFvUZ1LtOPiFhS3wK8oAyq4HkTQr7Xylu-LqO8S4m2uKXa9QRd8eEnmI4e6DYCKtYu8Ji8h7Zs3DHnaKRnDM3RhKsFLycS-Ie_OdSKZnJx7xYx6uTO08zYCqcvnEX7pzTsLSiTMUHJ3vio-YipIsV-NzRDF1x-lMkWUGMk95g/s1442/image_2022-03-25_233834.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="600" data-original-width="1442" height="244" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjfV8HV1ON0BjYWXD5oyFvUZ1LtOPiFhS3wK8oAyq4HkTQr7Xylu-LqO8S4m2uKXa9QRd8eEnmI4e6DYCKtYu8Ji8h7Zs3DHnaKRnDM3RhKsFLycS-Ie_OdSKZnJx7xYx6uTO08zYCqcvnEX7pzTsLSiTMUHJ3vio-YipIsV-NzRDF1x-lMkWUGMk95g/w588-h244/image_2022-03-25_233834.png" width="588" /></a></span></div><span style="font-family: verdana;"><br /><b><br /></b></span><p></p><p><span style="font-family: verdana;"><b>- Vì ở đây chương trình lấy 15 kí tự nhưng thanh ghi này là 16 byte nên lúc ghi vào thanh ghi 128 bit thì byte thứ 16 sẽ là 0 , Chúng ta sử dụng Z3 để giải bài này :(<a href="https://gist.github.com/Ajomix/3afb7bbdf0a36accf9935d9fc4e761b3" target="_blank">source</a>)</b></span></p><p><span style="font-family: verdana;"></span></p><div class="separator" style="clear: both; text-align: center;"><span style="font-family: verdana;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhhut4edIMKehppHUqDlIbqnDvpOukxgJt2kBwtZtNzo9-CribAOlql9FHHilO4HMZnzo4wcSrria5sbf8WUaDNWZpDl2dLU_UZsG4sWV2_6fEqkKQ85_Sfm9M7UhrttPWonnLgAE2KI3fl2Mo-ZjE_YFiIhW97ie7FPx0psHNClXVg-e3xcOTOh2x_Q/s1049/image_2022-03-25_234103.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="951" data-original-width="1049" height="522" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhhut4edIMKehppHUqDlIbqnDvpOukxgJt2kBwtZtNzo9-CribAOlql9FHHilO4HMZnzo4wcSrria5sbf8WUaDNWZpDl2dLU_UZsG4sWV2_6fEqkKQ85_Sfm9M7UhrttPWonnLgAE2KI3fl2Mo-ZjE_YFiIhW97ie7FPx0psHNClXVg-e3xcOTOh2x_Q/w576-h522/image_2022-03-25_234103.png" width="576" /></a></span></div><span style="font-family: verdana;"><br /><b><br /></b></span><p></p><p><span style="font-family: verdana;"><b>flag :&nbsp;CTF{S1MDf0rM3!}</b></span></p><p><span style="font-family: verdana;"><b><br /></b></span></p><p><span style="font-family: verdana;"><b><br /></b></span></p><p><span style="font-family: verdana;"><b><br /></b></span></p><p><span style="font-family: verdana;"><b><br /></b></span></p><p><span style="font-family: verdana;"><b><br /></b></span></p>
